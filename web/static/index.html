<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Character Prompt Generator</title>
  <link rel="stylesheet" href="/static/css/variables.css">
  <link rel="stylesheet" href="/static/css/layout.css">
  <link rel="stylesheet" href="/static/css/slots.css">
  <link rel="stylesheet" href="/static/css/controls.css">
</head>
<body>
  <header>
    <h1 id="page-heading">Random Anime Character Prompt Generator</h1>
    <div id="language-controls">
      <label for="ui-lang-select" id="ui-lang-label">UI Language</label>
      <select id="ui-lang-select"></select>
      <label for="prompt-lang-select" id="prompt-lang-label">Prompt Language</label>
      <select id="prompt-lang-select"></select>
    </div>
  </header>

  <details id="save-load-section" open>
    <summary id="save-load-summary">Save / Load Configuration</summary>
    <div id="save-load-content">
      <div id="save-row">
        <input type="text" id="config-name" placeholder="my_character">
        <button id="btn-save" class="btn">Save</button>
      </div>
      <div id="load-row">
        <select id="config-select">
          <option value="">(Select config)</option>
        </select>
        <button id="btn-load" class="btn">Load</button>
        <button id="btn-refresh-configs" class="btn btn-sm">Refresh</button>
      </div>
      <div id="export-import-row">
        <button id="btn-export" class="btn btn-sm">Export Data</button>
        <button id="btn-import" class="btn btn-sm">Import Data</button>
      </div>
      <div id="save-status"></div>
    </div>
  </details>

  <details id="shortcuts-section">
    <summary id="shortcuts-summary">Keyboard Shortcuts</summary>
    <div id="shortcuts-content">
      <table id="shortcuts-table">
        <thead>
          <tr>
            <th id="shortcuts-col-action">Action</th>
            <th id="shortcuts-col-shortcut">Shortcut</th>
            <th id="shortcuts-col-change">Change</th>
          </tr>
        </thead>
        <tbody id="shortcuts-list">
          <!-- Populated by JavaScript -->
        </tbody>
      </table>
    </div>
  </details>

  <section id="prompt-section">
    <div id="prompt-prefix-wrap">
      <label for="prompt-prefix" id="prompt-prefix-label">Always Include (Stable Diffusion Prefix)</label>
      <div id="prompt-prefix-controls">
        <label for="prompt-prefix-preset" id="prefix-preset-label">Preset</label>
        <select id="prompt-prefix-preset">
          <option value="" id="prefix-preset-none">(None)</option>
          <option value="sd_quality_v1" id="prefix-preset-sd">SD quality preset (masterpiece / best quality / absurdres)</option>
        </select>
      </div>
      <textarea id="prompt-prefix" rows="2" placeholder="Optional text prepended to every generated prompt..."></textarea>
    </div>

    <label class="setting" for="prompt-colorize-toggle">
      <input type="checkbox" id="prompt-colorize-toggle" checked>
      <span id="colorize-label">Colorize prompt output</span>
    </label>

    <div id="prompt-output" data-placeholder="Generated prompt will appear here..." aria-live="polite" contenteditable="true"></div>

    <div id="prompt-buttons">
      <button id="btn-generate" class="btn btn-primary">Generate Prompt</button>
      <button id="btn-randomize-all" class="btn btn-secondary">Randomize All</button>
      <button id="btn-copy" class="btn">Copy</button>
      <button id="btn-reset" class="btn">Reset</button>
      <button id="btn-parse" class="btn" title="Parse prompt text back to slot settings">Parse to Slots</button>
      <button id="btn-save-parsed" class="btn btn-parsed hidden" title="Save parsed result as a configuration">Save Parsed Config</button>
    </div>

    <details id="history-section">
      <summary id="history-summary">Prompt History (<span id="history-count">0</span>)</summary>
      <div id="history-content">
        <div id="history-list"></div>
        <div id="history-actions">
          <button id="btn-clear-history" class="btn btn-sm">Clear All History</button>
        </div>
      </div>
    </details>
  </section>

  <section id="settings-bar">
    <label class="setting">
      <input type="checkbox" id="full-body-mode">
      <span id="setting-full-body">Full-body specific outfit</span>
    </label>

    <label class="setting">
      <input type="checkbox" id="upper-body-mode">
      <span id="setting-upper-body">Upper-body mode</span>
    </label>

    <label class="setting">
      <input type="checkbox" id="palette-enabled" checked>
      <span id="setting-palette">Use Palette Colors</span>
    </label>

    <div class="setting setting-palette">
      <label for="palette-picker-btn" id="palette-label">Palette:</label>
      <div id="palette-picker" class="palette-picker">
        <button id="palette-picker-btn" type="button" class="palette-picker-btn" aria-haspopup="listbox" aria-expanded="false">
          <span id="palette-picker-name">(None)</span>
          <span id="palette-picker-swatches" class="palette-swatches"></span>
          <span class="palette-picker-caret">▼</span>
        </button>
        <div id="palette-picker-menu" class="palette-picker-menu" role="listbox" aria-label="Palette options"></div>
      </div>
      <button id="btn-palette-lock" type="button" class="btn-lock" title="Lock palette during Randomize All">🔓</button>
      <button id="btn-palette-random" type="button" class="btn btn-sm" title="Randomize palette">Random Palette</button>
      <select id="palette-select" class="palette-select-hidden" aria-hidden="true" tabindex="-1">
        <option value="">(None)</option>
      </select>
    </div>

    <label class="setting">
      <input type="checkbox" id="click-scroll-enabled" checked>
      <span id="setting-click-scroll">Click-to-scroll</span>
      <kbd id="click-scroll-shortcut" class="shortcut-key" title="Click to change shortcut">Ctrl+J</kbd>
    </label>
  </section>

  <hr>

  <div id="sections-container"></div>

  <script type="module" src="/static/js/app.js"></script>
</body>
</html>
